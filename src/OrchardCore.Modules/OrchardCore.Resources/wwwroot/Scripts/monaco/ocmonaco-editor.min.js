require.config({paths:{vs:document.currentScript.dataset.tenantPrefix+"/OrchardCore.Resources/Scripts/monaco/vs"}});var $document=$(document);$document.ready((function(){function e(e,t,a){var o;return function(){var n=this,r=arguments,i=function(){o=null,a||e.apply(n,r)},s=a&&!o;clearTimeout(o),o=setTimeout(i,t),s&&e.apply(n,r)}}require(["vs/editor/editor.main"],(function(){var t=document.getElementsByTagName("html")[0];function a(){"darkmode"===t.dataset.theme?monaco.editor.setTheme("vs-dark"):monaco.editor.setTheme("vs")}function o(t){var a=$(t);if(null==a.data("monaco")){var o=document.getElementById(t.dataset.textareaId);if(t.dataset.diagnosticsOptions){var n=atob(t.dataset.diagnosticsOptions);monaco.languages.json.jsonDefaults.setDiagnosticsOptions(JSON.parse(n))}var r={};t.dataset.language&&(r.language=t.dataset.language),t.dataset.settings&&(r=JSON.parse(atob(t.dataset.settings)));var i=Object.assign({},{wordWrap:"on",scrollBeyondLastLine:!1,scrollbar:{alwaysConsumeMouseWheel:!1}},r);if("liquid"==r.language&&"function"==typeof ConfigureLiquidIntellisense&&ConfigureLiquidIntellisense(monaco),i.automaticLayout=!1,t.dataset.schema){var s=t.dataset.schemaName,c=monaco.Uri.parse("x://".concat(s,".json")),d=JSON.parse(t.dataset.schema);i.model=monaco.editor.createModel(o.value,i.language,c),monaco.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{uri:"x://".concat(s,".schema.json"),fileMatch:[c.toString()],schema:d}]})}var u=monaco.editor.create(t,i);if(u.getModel().setValue(o.value),window.addEventListener("submit",(function(){o.value=u.getValue()})),t.dataset.preview){var l=e((function(e){o.value=u.getValue(),$document.trigger("contentpreview:render")}),500);u.getModel().onDidChangeContent(l)}var m=1e3;t.dataset.maxHeight&&(m=t.dataset.maxHeight);var g=function(){var e=t.parentElement.clientWidth,a=0==m?u.getContentHeight():Math.min(m,u.getContentHeight());t.style.width="".concat(e,"px"),t.style.height="".concat(a+20,"px"),u.layout({width:e-20,height:a})};u.onDidContentSizeChange(g),g();var v=e(g,150);if(window.addEventListener("resize",v),t.dataset.shortcodes){var h={id:"shortcodes",label:"Add Shortcode",run:function(e){shortcodesApp.init((function(t){if(t){var a={range:e.getSelection(),text:t,forceMoveMarkers:!0};e.executeEdits("shortcodes",[a])}e.focus()}))},contextMenuGroupId:"orchardcore",contextMenuOrder:0,keybindings:[monaco.KeyMod.Alt|monaco.KeyCode.KEY_S]};u.addAction(h)}if(t.dataset.templatePreview){var f=document.getElementById(t.dataset.nameId),p=$("[name='__RequestVerificationToken']").val(),y=e((function(e){var t;t={Name:f.value,Content:u.getValue(),__RequestVerificationToken:p},localStorage.setItem("OrchardCore.templates",JSON.stringify($.param(t)))}),500);u.getModel().onDidChangeContent(y),window.addEventListener("storage",(function(e){"OrchardCore.templates:ready"==e.key&&y()}),!1),window.addEventListener("unload",(function(){localStorage.removeItem("OrchardCore.templates"),localStorage.setItem("OrchardCore.templates:not-connected",""),localStorage.removeItem("OrchardCore.templates:not-connected")}))}a.data("monaco",{editor:u,updateHeight:g})}}new MutationObserver(a).observe(t,{attributes:!0}),a(),document.querySelectorAll("[data-monaco-oc]").forEach(o),document.addEventListener("init-editors",(function(e){window.requestAnimationFrame((function(){document.querySelectorAll("[data-monaco-oc]").forEach((function(e){var t=$(e).data("monaco");t?t.updateHeight():o(e)}))}))}),!1)}))}));
